"use strict";(()=>{var e={};e.id=218,e.ids=[218],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27098:(e,t,o)=>{o.r(t),o.d(t,{headerHooks:()=>y,originalPathname:()=>g,patchFetch:()=>w,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>k,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>f});var r={};o.r(r),o.d(r,{GET:()=>u});var a=o(95419),i=o(69108),n=o(99678),s=o(98984);let c=process.env.FINNHUB_API_KEY,p=process.env.ALPHA_VANTAGE_API_KEY,l=async e=>{let t=await fetch(e);if(!t.ok)throw Error(`Failed to fetch data from ${e}`);return t.json()};async function u(e){let{searchParams:t}=new URL(e.url),o=t.get("symbol");if(!o)return new s.NextResponse(JSON.stringify({error:"Symbol is required"}),{status:400,headers:{"Content-Type":"application/json"}});try{let e=`https://finnhub.io/api/v1/quote?symbol=${o}&token=${c}`,t=`https://finnhub.io/api/v1/stock/profile2?symbol=${o}&token=${c}`,r=`https://finnhub.io/api/v1/stock/metric?symbol=${o}&metric=all&token=${c}`,a=`https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${o}&apikey=${p}`,[i,n,u,d]=await Promise.all([l(e),l(t),l(r),l(a)]);if(!i||!n||!u)return new s.NextResponse(JSON.stringify({error:"Data not found"}),{status:404,headers:{"Content-Type":"application/json"}});let h=[];if(d&&d["Time Series (Daily)"]){let e=d["Time Series (Daily)"];h=Object.keys(e).map(t=>({timestamp:new Date(t).toISOString(),price:parseFloat(e[t]["4. close"])}))}let m={companyName:n.name,ticker:o,exchange:n.exchange,currentPrice:i.c,change:{amount:parseFloat((i.c-i.pc).toFixed(2)),percentage:parseFloat(((i.c-i.pc)/i.pc*100).toFixed(2))},chartData:h,open:i.o,high:i.h,low:i.l,previousClose:i.pc,marketCap:u.metric.marketCapitalization,peRatio:u.metric.peBasicExclExtraTTM,dividendYield:`${(100*u.metric.dividendYieldIndicatedAnnual).toFixed(2)}%`,high52Week:u.metric["52WeekHigh"],low52Week:u.metric["52WeekLow"]};return new s.NextResponse(JSON.stringify(m),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error fetching stock data",e),new s.NextResponse(JSON.stringify({error:"An error occurred while fetching stock data"}),{status:500,headers:{"Content-Type":"application/json"}})}}let d=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/stock/route",pathname:"/api/stock",filename:"route",bundlePath:"app/api/stock/route"},resolvedPagePath:"/home/pc-1827/Desktop/practice/assignments/blubeeai_assignment/omniplex/src/app/api/stock/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:k,headerHooks:y,staticGenerationBailout:f}=d,g="/api/stock/route";function w(){return(0,n.patchFetch)({serverHooks:k,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[638,791],()=>o(27098));module.exports=r})();